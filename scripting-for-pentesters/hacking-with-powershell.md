# Hacking with PowerShell

## Task 2 What is Powershell?

#### What is the command to get help about a particular cmdlet?

{% hint style="success" %}
Get-Help
{% endhint %}

## Task 3 Basic Powershell Commands

#### What is the location of the file "interesting-file.txt"

```
Get-ChildItem -Path C:\ -Recursive -File -Include *interesting-file.txt* `
              -ErrorAction SilentlyContinue
```

{% hint style="success" %}
`C:\Program Files`
{% endhint %}

#### Specify the contents of this file

```
Get-Content -Path 'C:\Program Files\interesting-file.txt.txt'
```

{% hint style="success" %}
`notsointerestingontent`
{% endhint %}

#### How many cmdlets are installed on the system(only cmdlets, not functions and aliases)?

```
Get-Command -Type cmdlet | Measure-Object
```

{% hint style="success" %}
`6638`
{% endhint %}

#### Get the MD5 hash of interesting-file.txt

```
Get-FileHash 'C:\Program Files\interesting-file.txt.txt' `
             -Algorithm MD5
```

{% hint style="success" %}
`49A586A2A9456226F8A1B4CEC6FAB329`
{% endhint %}

#### What is the command to get the current working directory?

```
Get-Alias | Where-Object -Property Name -Contains pwd
```

{% hint style="success" %}
`Get-Location`
{% endhint %}

#### Does the path "C:\Users\Administrator\Documents\Passwords" Exist(Y/N)?

```
Get-Content -Path C:\Users\Administrator\Documents\Passwords
```

{% hint style="success" %}
`N`
{% endhint %}

#### What command would you use to make a request to a web server?

```
Get-Alias | Where-Object -Property Name -Contains wget
```

{% hint style="success" %}
`Invoke-WebRequest`
{% endhint %}

#### Base64 decode the file b64.txt on Windows.&#x20;

```
Get-ChildItem -Path C:\ -Recursive -File -Include *b64.txt* `
              -ErrorAction SilentlyContinue
[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String((Get-Content -Path C:\Users\Administrator\Desktop\b64.txt)))
```

{% hint style="success" %}
`ihopeyoudidthisonwindows`
{% endhint %}

## Task 4 Enumeration

#### How many users are there on the machine?

```
Get-LocalUser | Measure-Object
```

{% hint style="success" %}
`5`
{% endhint %}

#### Which local user does this SID(S-1-5-21-1394777289-3961777894-1791813945-501) belong to?

```
Get-LocalUser -SID S-1-5-21-1394777289-3961777894-1791813945-501
```

{% hint style="success" %}
`Guest`
{% endhint %}

#### How many users have their password required values set to False?

```
Get-LocalUser | Where-Object -Property PasswordRequired -EQ $False | Measure-Object
```

{% hint style="success" %}
`4`
{% endhint %}

#### How many local groups exist?

```
Get-LocalGroup | Measure-Object
```

{% hint style="success" %}
`24`
{% endhint %}

#### What command did you use to get the IP address info?

{% hint style="success" %}
`Get-NetIPAddress`
{% endhint %}

#### How many ports are listed as listening?

```
Get-NetTCPConnection -State Listen | Measure-Object
```

{% hint style="success" %}
20
{% endhint %}

#### What is the remote address of the local port listening on port 445?

```
Get-NetTCPConnection -State Listen | Where-Object -Property LocalPort -EQ 445
```

{% hint style="success" %}
`::`
{% endhint %}

#### How many patches have been applied?

```
Get-WmiObject -Class win32_quickfixengineering | Measure-Object
```

{% hint style="success" %}
`20`
{% endhint %}

#### When was the patch with ID KB4023834 installed?

```
Get-WmiObject -Class win32_quickfixengineering `
| Where-Object -Property HotFixID KB4023834 `
| Select-Object -Property InstalledOn                                                                -EQ
```

{% hint style="success" %}
`6/15/2017 12:00:00 AM`
{% endhint %}

#### Find the contents of a backup file.

```
Get-ChildItem -Path C:\ -Recursive -File -Include *bak* `
              -ErrorAction SilentlyContinue | Select-Object FullName 
Get-Content -Path 'C:\Program Files (x86)\Internet Explorer\passwords.bak.txt'
```

{% hint style="success" %}
`backpassflag`
{% endhint %}

#### Search for all files containing API\_KEY

```
Get-ChildItem -Path C:\ -Recursive -File | Select-String "API_KEY" -List ` 
                                         | Select-Object -Property Path
Get-Content -Path C:\Users\Public\Music\config.xml
```

{% hint style="success" %}
`fakekey123`
{% endhint %}

#### What command do you do to list all the running processes?

```
Get-Alias | Where-Object -Property Name -Contains ps
```

{% hint style="success" %}
`Get-Process`
{% endhint %}

#### What is the path of the scheduled task called new-sched-task?

```
Get-ScheduledTask -TaskName new-sched-task
```

{% hint style="success" %}
`/`
{% endhint %}

#### Who is the owner of the C:\\

```
Get-Acl C:\
```

{% hint style="success" %}
`NT SERVICE\TrustedInstaller`
{% endhint %}

## Task 5 Basic Scripting Challenge

#### What file contains the password?

```
Get-ChildItem -Path C:\Users\Administrator\Desktop\emails -Recursive -File `
| Select-String 'password' | Select-Object -Property Path, Line
```

#### What is the password?

{% hint style="success" %}
`johnisalegend99`
{% endhint %}

#### What files contains an HTTPS link?

```
Get-ChildItem -Path C:\Users\Administrator\Desktop\emails -Recursive -File `
| Select-String 'https' | Select-Object -Property Path, Line
```

## Task 6 Intermediate Scripting

#### How many open ports did you find between 130 and 140 (inclusive of those two)?

```
$j = 0
for ($i = 130; $i -le 140; $i++) {
    if (Test-NetConnection -Port $i -ComputerName 127.0.0.1 `
                           -WarningAction SilentlyContinue) {
        Write-Host "$i/tcp Open"
        $j++
    }
}

Write-Host "$j open ports"
```

{% hint style="success" %}
`11`
{% endhint %}
