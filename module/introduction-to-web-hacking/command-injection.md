# Command Injection

{% embed url="https://tryhackme.com/room/oscommandinjection" %}
https://tryhackme.com/room/oscommandinjection
{% endembed %}

## Task 2 Discovering Command Injection

#### What variable stores the user's input in the PHP code snippet in this task?

![](<../../.gitbook/assets/image (4).png>)

{% hint style="success" %}
`title`
{% endhint %}

#### What HTTP method is used to retrieve data submitted by a user in the PHP code snippet?

{% hint style="success" %}
`GET`
{% endhint %}

#### If I wanted to execute the `id` command in the Python code snippet, what route would I need to visit?

![](<../../.gitbook/assets/image (6).png>)

{% hint style="success" %}
`/id`
{% endhint %}

## Task 3 Exploiting Command Injection

#### What payload would I use if I wanted to determine what user the application is running as?

{% hint style="success" %}
`whoami`
{% endhint %}

#### What popular network tool would I use to test for blind command injection on a **Linux** machine?

{% hint style="success" %}
`ping`
{% endhint %}

#### What payload would I use to test a **Windows** machine for blind command injection?

{% hint style="success" %}
`timeout`
{% endhint %}

## Task 4 Remediating Command Injection

#### What is the term for the process of "cleaning" user input that is provided to an application?

{% hint style="success" %}
`sanitisation`
{% endhint %}

## Task 5 Practical: Command Injection

#### What user is this application running as?

![](<../../.gitbook/assets/Screenshot from 2022-03-31 07-20-42.png>)

{% hint style="success" %}
`www-data`
{% endhint %}

#### What are the contents of the flag located in /home/tryhackme/flag.txt?

![](<../../.gitbook/assets/Screenshot from 2022-03-31 07-21-04.png>)

{% hint style="success" %}
`THM{COMMAND_INJECTION_COMPLETE}`
{% endhint %}
