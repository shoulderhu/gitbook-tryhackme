---
description: >-
  This room covers the principle uses of PowerShell in Penetration Tests.
  Interacting with files, scanning the network and system enumeration are
  covered.
---

# PowerShell for Pentesters

{% embed url="https://tryhackme.com/room/powershellforpentesters" %}
https://tryhackme.com/room/powershellforpentesters
{% endembed %}

## Task 1 Intro

#### What useful PowerShell script did you find on Walter's desktop?

```
Get-ChildItem -Path C:\Users\Walter\Desktop
```

{% hint style="success" %}
`powerview.ps1`
{% endhint %}

## Task 2 Manipulating files

#### What is the MD5 hash value of the file on Walter's desktop?

```
Get-FileHash C:\Users\Walter\Desktop\powerview.ps1 -Algorithm MD5
```

{% hint style="success" %}
`501570FFBA7FACE69D61DA1A0843E89A`
{% endhint %}

## Task 4 System Reconnaissance

#### What Windows Security Update was installed on 5/15/2019?

```
Get-HotFix -Description Security* `
| Where-Object -Property InstalledOn -Contains 5/15/2019
```

{% hint style="success" %}
`KB4499728`
{% endhint %}

## Task 6 Using PowerView

#### One of the accounts has a special description; what is it?

```
Get-NetUser | Select-Object -Property description
```

{% hint style="success" %}
`IDF-17828290`
{% endhint %}

#### How many accounts are disabled?

```
Get-NetUser -UACFilter ACCOUNTDISABLE | Measure-Object
```

{% hint style="success" %}
`4`
{% endhint %}

#### How many users are in the "domain admins" group?

```
Get-NetGroupMember "domain admins" | Measure-Object
```

{% hint style="success" %}
`3`
{% endhint %}

#### Which users are in the "domain admins" group?

```
Get-NetGroupMember "domain admins" | Select-Object -Property MemberName `
                                   | Sort-Object
```

{% hint style="success" %}
`ServerAdmin, ssik, usand`
{% endhint %}

#### List shares; what is the name of the "interesting" share?

```
Get-NetShare
```

{% hint style="success" %}
`operationfiles`
{% endhint %}

#### What is the name of the user-created Group Policy?

```
Get-NetGPO | Select-Object -Property displayname, whencreated
```

{% hint style="success" %}
`Disable WinDef`
{% endhint %}

#### What are the first names of users' whose accounts were disabled?

```
Get-NetUser -UACFilter ACCOUNTDISABLE | Select-Object -Property givenname 
```

{% hint style="success" %}
`Daniel, Ursula`
{% endhint %}
