# Intro to Malware Analysis

{% embed url="https://tryhackme.com/room/intromalwareanalysis" %}
https://tryhackme.com/room/intromalwareanalysis
{% endembed %}

## Task 2 Malware Analysis

#### Which team uses malware analysis to look for IOCs and hunt for malware in a network?

{% hint style="success" %}
`Threat Hunt Team`
{% endhint %}

## Task 3 Techniques of malware analysis

#### Which technique is used for analyzing malware without executing it?

{% hint style="success" %}
`Static Analysis`
{% endhint %}

#### Which technique is used for analyzing malware by executing it and observing its behavior in a controlled environment?

{% hint style="success" %}
`Dynamic Analysis`
{% endhint %}

## Task 4 Basic Static Analysis

```bash
ssh ubuntu@10.10.126.79
cd Desktop/Samples
```

#### In the attached VM, there is a sample named 'redline' in the Desktop/Samples directory. What is the md5sum of this sample?

```bash
md5sum redline
```

![](<../../.gitbook/assets/Screenshot from 2022-04-28 05-52-18.png>)

{% hint style="success" %}
`ca2dc5a3f94c4f19334cc8b68f256259`
{% endhint %}

#### What is the creation time of this sample?

![](<../../.gitbook/assets/Screenshot from 2022-04-28 05-52-05.png>)

{% hint style="success" %}
`2020-08-01 02:44:18 UTC`
{% endhint %}

## Task 5 The PE file Header

#### In the attached VM, there is a sample named 'redline' in the directory Desktop/Samples. What is the entropy of the .text section of this sample?

```bash
pecheck redline
```

![](<../../.gitbook/assets/Screenshot from 2022-04-28 06-03-14.png>)

{% hint style="success" %}
`6.453919`
{% endhint %}

#### The sample named 'redline' has five sections. .text, .rdata, .data and .rsrc are four of them. What is the name of the fifth section?

{% hint style="success" %}
`.ndata`
{% endhint %}

#### From which dll file does the sample named 'redline' import the RegOpenKeyExW function?

![](<../../.gitbook/assets/Screenshot from 2022-04-28 06-04-56.png>)

{% hint style="success" %}
`ADVAPI32.dll`
{% endhint %}

#### Check out the GUI-based Petree tool and see what information it shows.

```
pe-tree redline
```

## Task 6 Basic Dynamic Analysis

#### Check the hash of the sample 'redline' on Hybrid analysis and check out the report generated on 14 March 2022. Check the Incident Response section of the report. How many domains were contacted by the sample?

![](<../../.gitbook/assets/Screenshot from 2022-04-28 06-25-09.png>)

{% hint style="success" %}
`8`
{% endhint %}

#### In the report mentioned above, a text file is created by the sample. What is the name of that text file?

![](<../../.gitbook/assets/Screenshot from 2022-04-28 06-26-44.png>)

{% hint style="success" %}
`fj4ghga23_fsa.txt`
{% endhint %}

## Task 7 Anti-analysis techniques

#### Which of the techniques discussed above is used to bypass static analysis?

{% hint style="success" %}
`packing`
{% endhint %}

#### Which technique discussed above is used to time out a sandbox?

{% hint style="success" %}
`Long sleep calls`
{% endhint %}
